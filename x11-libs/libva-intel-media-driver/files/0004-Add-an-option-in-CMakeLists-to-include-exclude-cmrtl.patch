From 83d38613bb42d577d95383d06bf7c4d6c2a2e609 Mon Sep 17 00:00:00 2001
From: He Fan F <fan.f.he@intel.com>
Date: Tue, 13 Nov 2018 17:58:35 -0800
Subject: [PATCH] Add an option in CMakeLists to include/exclude cmrtlib build

https://github.com/intel/media-driver/pull/394

Signed-off-by: He Fan F <fan.f.he@intel.com>
---
 CMakeLists.txt               | 10 ++++++++--
 cmrtlib/linux/CMakeLists.txt |  2 --
 2 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 77f7416e4019..af42630c13dc 100755
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -40,9 +40,13 @@ if("${os_name}" STREQUAL "clear-linux-os")
     set(CMAKE_INSTALL_SYSCONFDIR "usr/share/defaults/etc")
 endif()
 
+option (BUILD_CMRTLIB "Build and Install cmrtlib together with media driver" ON)
+
 include(GNUInstallDirs)
 
-add_subdirectory(cmrtlib)
+if(BUILD_CMRTLIB)
+    add_subdirectory(cmrtlib)
+endif()
 
 add_subdirectory(media_driver)
 
@@ -52,7 +56,9 @@ endif()
 message(STATUS "LIBVA_DRIVERS_PATH = ${LIBVA_DRIVERS_PATH}")
 
 install (FILES ${CMAKE_CURRENT_BINARY_DIR}/media_driver/iHD_drv_video.so DESTINATION ${LIBVA_DRIVERS_PATH} COMPONENT media)
-install (FILES ${CMAKE_CURRENT_BINARY_DIR}/cmrtlib/linux/igfxcmrt64.so DESTINATION ${CMAKE_INSTALL_LIBDIR} COMPONENT media)
+if(BUILD_CMRTLIB)
+    install (FILES ${CMAKE_CURRENT_BINARY_DIR}/cmrtlib/linux/igfxcmrt64.so DESTINATION ${CMAKE_INSTALL_LIBDIR} COMPONENT media)
+endif()
 
 option (INSTALL_DRIVER_SYSCONF "Install driver system configuration file" ON)
 if (INSTALL_DRIVER_SYSCONF)
diff --git a/cmrtlib/linux/CMakeLists.txt b/cmrtlib/linux/CMakeLists.txt
index 1dca812dd0d7..b2af5614d4bd 100644
--- a/cmrtlib/linux/CMakeLists.txt
+++ b/cmrtlib/linux/CMakeLists.txt
@@ -79,8 +79,6 @@ set(CMRT_DEFINES "")
 cmrt_include_directory(${CMAKE_CURRENT_LIST_DIR}/../agnostic)
 cmrt_include_directory(${CMAKE_CURRENT_LIST_DIR}/../linux)
 
-setup_library(igfxcmrt "${CMRT_SOURCES}" TRUE "igfxcmrt${TARGET_MODIFIER}")
-
 set(CMRT_DEFINES ${CMRT_DEFINES} VPHAL ISTDLIB_UMD CM_RT_EXPORTS)
 
 # Extra defines for 64 bit builds
-- 
2.19.0

