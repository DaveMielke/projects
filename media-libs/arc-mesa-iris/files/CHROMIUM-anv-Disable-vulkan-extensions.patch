From bcadcabbbf62305ba27dd677e0668b39c837149f Mon Sep 17 00:00:00 2001
From: Nataraj Deshpande <nataraj.deshpande@intel.com>
Date: Thu, 16 Apr 2020 12:27:24 -0700
Subject: [PATCH] CHROMIUM: anv: Disable vulkan extensions

Change-Id: Idb708b83119501e208a7f23fb8189bf98a225668
---
 src/intel/vulkan/anv_extensions.py | 37 +++++++++++++++---------------
 1 file changed, 18 insertions(+), 19 deletions(-)

diff --git a/src/intel/vulkan/anv_extensions.py b/src/intel/vulkan/anv_extensions.py
index 80ebb9a7f86..f301e6114ca 100644
--- a/src/intel/vulkan/anv_extensions.py
+++ b/src/intel/vulkan/anv_extensions.py
@@ -65,20 +65,20 @@ MAX_API_VERSION = None # Computed later
 # the those extension strings, then tests dEQP-VK.api.info.instance.extensions
 # and dEQP-VK.api.info.device fail due to the duplicated strings.
 EXTENSIONS = [
-    Extension('VK_KHR_8bit_storage',                      1, 'device->info.gen >= 8'),
+    Extension('VK_KHR_8bit_storage',                      1, False),
     Extension('VK_KHR_16bit_storage',                     1, 'device->info.gen >= 8'),
     Extension('VK_KHR_bind_memory2',                      1, True),
     Extension('VK_KHR_buffer_device_address',             1,
               'device->has_a64_buffer_access && device->info.gen < 12'),
     Extension('VK_KHR_create_renderpass2',                1, True),
     Extension('VK_KHR_dedicated_allocation',              1, True),
-    Extension('VK_KHR_depth_stencil_resolve',             1, True),
+    Extension('VK_KHR_depth_stencil_resolve',             1, False),
     Extension('VK_KHR_descriptor_update_template',        1, True),
     Extension('VK_KHR_device_group',                      1, True),
     Extension('VK_KHR_device_group_creation',             1, True),
     Extension('VK_KHR_display',                          23, 'VK_USE_PLATFORM_DISPLAY_KHR'),
     Extension('VK_KHR_draw_indirect_count',               1, True),
-    Extension('VK_KHR_driver_properties',                 1, True),
+    Extension('VK_KHR_driver_properties',                 1, False),
     Extension('VK_KHR_external_fence',                    1,
               'device->has_syncobj_wait'),
     Extension('VK_KHR_external_fence_capabilities',       1, True),
@@ -95,36 +95,35 @@ EXTENSIONS = [
     Extension('VK_KHR_get_physical_device_properties2',   1, True),
     Extension('VK_KHR_get_surface_capabilities2',         1, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_image_format_list',                 1, True),
-    Extension('VK_KHR_imageless_framebuffer',             1, True),
+    Extension('VK_KHR_imageless_framebuffer',             1, False),
     Extension('VK_KHR_incremental_present',               1, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_maintenance1',                      1, True),
     Extension('VK_KHR_maintenance2',                      1, True),
     Extension('VK_KHR_maintenance3',                      1, True),
     Extension('VK_KHR_multiview',                         1, True),
-    Extension('VK_KHR_pipeline_executable_properties',    1, True),
+    Extension('VK_KHR_pipeline_executable_properties',    1, False),
     Extension('VK_KHR_push_descriptor',                   1, True),
     Extension('VK_KHR_relaxed_block_layout',              1, True),
     Extension('VK_KHR_sampler_mirror_clamp_to_edge',      1, True),
     Extension('VK_KHR_sampler_ycbcr_conversion',          1, True),
-    Extension('VK_KHR_separate_depth_stencil_layouts',    1, True),
-    Extension('VK_KHR_shader_atomic_int64',               1,
-              'device->info.gen >= 9 && device->use_softpin'),
-    Extension('VK_KHR_shader_clock',                      1, True),
+    Extension('VK_KHR_separate_depth_stencil_layouts',    1, False),
+    Extension('VK_KHR_shader_atomic_int64',               1, False),
+    Extension('VK_KHR_shader_clock',                      1, False),
     Extension('VK_KHR_shader_draw_parameters',            1, True),
-    Extension('VK_KHR_shader_float16_int8',               1, 'device->info.gen >= 8'),
-    Extension('VK_KHR_shader_float_controls',             1, 'device->info.gen >= 8'),
-    Extension('VK_KHR_shader_non_semantic_info',          1, True),
-    Extension('VK_KHR_shader_subgroup_extended_types',    1, 'device->info.gen >= 8'),
-    Extension('VK_KHR_spirv_1_4',                         1, True),
+    Extension('VK_KHR_shader_float16_int8',               1, False),
+    Extension('VK_KHR_shader_float_controls',             1, False),
+    Extension('VK_KHR_shader_non_semantic_info',          1, False),
+    Extension('VK_KHR_shader_subgroup_extended_types',    1, False),
+    Extension('VK_KHR_spirv_1_4',                         1, False),
     Extension('VK_KHR_storage_buffer_storage_class',      1, True),
     Extension('VK_KHR_surface',                          25, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_surface_protected_capabilities',    1, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_swapchain',                        70, 'ANV_HAS_SURFACE'),
     Extension('VK_KHR_swapchain_mutable_format',          1, 'ANV_HAS_SURFACE'),
-    Extension('VK_KHR_timeline_semaphore',                1, True),
-    Extension('VK_KHR_uniform_buffer_standard_layout',    1, True),
+    Extension('VK_KHR_timeline_semaphore',                1, False),
+    Extension('VK_KHR_uniform_buffer_standard_layout',    1, False),
     Extension('VK_KHR_variable_pointers',                 1, True),
-    Extension('VK_KHR_vulkan_memory_model',               3, True),
+    Extension('VK_KHR_vulkan_memory_model',               3, False),
     Extension('VK_KHR_wayland_surface',                   6, 'VK_USE_PLATFORM_WAYLAND_KHR'),
     Extension('VK_KHR_xcb_surface',                       6, 'VK_USE_PLATFORM_XCB_KHR'),
     Extension('VK_KHR_xlib_surface',                      6, 'VK_USE_PLATFORM_XLIB_KHR'),
@@ -170,8 +169,8 @@ EXTENSIONS = [
     Extension('VK_EXT_ycbcr_image_arrays',                1, True),
     Extension('VK_ANDROID_external_memory_android_hardware_buffer', 3, 'ANDROID'),
     Extension('VK_ANDROID_native_buffer',                 7, 'ANDROID'),
-    Extension('VK_GOOGLE_decorate_string',                1, True),
-    Extension('VK_GOOGLE_hlsl_functionality1',            1, True),
+    Extension('VK_GOOGLE_decorate_string',                1, False),
+    Extension('VK_GOOGLE_hlsl_functionality1',            1, False),
     Extension('VK_INTEL_performance_query',               1, 'device->perf'),
     Extension('VK_INTEL_shader_integer_functions2',       1, 'device->info.gen >= 8'),
     Extension('VK_NV_compute_shader_derivatives',         1, True),
-- 
2.24.1

