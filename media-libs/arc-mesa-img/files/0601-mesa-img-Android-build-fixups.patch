From d9aaefb298c760fcf04f022adb09daaa343a6adb Mon Sep 17 00:00:00 2001
From: Nicolas Boichat <drinkcat@google.com>
Date: Mon, 11 Apr 2016 16:57:47 +0800
Subject: [PATCH] mesa-img: Android build fixups

Change-Id: I98d79aa4947a8948195a1d56e0bec0a193e7708b
---
 configure.ac                         | 2 +-
 src/mesa/drivers/dri/pvr/Makefile.am | 9 +++++++--
 2 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/configure.ac b/configure.ac
index c4afd0f..1604b3b 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1612,7 +1612,7 @@ if test -n "$with_dri_drivers"; then
         xpvr)
             HAVE_PVR_DRI=yes;
             PKG_CHECK_MODULES([PVR], [libdrm >= $LIBDRM_PVR_REQUIRED])
-            DRI_LIB_DEPS="$DRI_LIB_DEPS -lpvr_dri_support"
+            DRI_LIB_DEPS="$DRI_LIB_DEPS $PVR_LIBS"
             ;;
         xswrast)
             HAVE_SWRAST_DRI=yes;
diff --git a/src/mesa/drivers/dri/pvr/Makefile.am b/src/mesa/drivers/dri/pvr/Makefile.am
index c3004da..1fbd8dd 100644
--- a/src/mesa/drivers/dri/pvr/Makefile.am
+++ b/src/mesa/drivers/dri/pvr/Makefile.am
@@ -12,7 +12,12 @@ AM_CFLAGS = \
 	-I$(top_builddir)/src/mesa/main \
 	$(DEFINES) \
 	$(VISIBILITY_CFLAGS) \
+	$(LIBDRM_CFLAGS) \
 	$(PVR_CFLAGS)
+
+if HAVE_EGL_PLATFORM_ANDROID
+AM_CFLAGS += -DHAVE_ANDROID_PLATFORM
+endif
 
 AM_CXXFLAGS = $(AM_CFLAGS)
 
-- 
1.9.1

