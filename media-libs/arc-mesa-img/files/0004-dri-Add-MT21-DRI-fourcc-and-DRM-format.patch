From 30672d03b08553a72d1a1c8cfa764282da02a29c Mon Sep 17 00:00:00 2001
From: Frank Binns <frank.binns@imgtec.com>
Date: Thu, 19 Mar 2015 14:07:23 +0000
Subject: [PATCH 03/11] dri: Add MT21 DRI fourcc and DRM format

Add the MT21 DRI fourcc and DRM format.

Change-Id: I5a7db596ba262cffff84014be572c14bae861b8a
---
 include/GL/internal/dri_interface.h | 1 +
 include/drm-uapi/drm_fourcc.h       | 2 ++
 src/egl/drivers/dri2/egl_dri2.c     | 3 +++
 3 files changed, 6 insertions(+)

diff --git a/include/GL/internal/dri_interface.h b/include/GL/internal/dri_interface.h
index fd26c121c65..376ef2a26ad 100644
--- a/include/GL/internal/dri_interface.h
+++ b/include/GL/internal/dri_interface.h
@@ -1350,6 +1350,7 @@ struct __DRIdri2ExtensionRec {
 #define __DRI_IMAGE_FOURCC_YUYV		0x56595559
 #define __DRI_IMAGE_FOURCC_UYVY		0x59565955
 #define __DRI_IMAGE_FOURCC_AYUV		0x56555941
+#define __DRI_IMAGE_FOURCC_MT21		0x3132544D
 
 #define __DRI_IMAGE_FOURCC_YVU410	0x39555659
 #define __DRI_IMAGE_FOURCC_YVU411	0x31315659
diff --git a/include/drm-uapi/drm_fourcc.h b/include/drm-uapi/drm_fourcc.h
index 686c074ecf4..8adcc0503a7 100644
--- a/include/drm-uapi/drm_fourcc.h
+++ b/include/drm-uapi/drm_fourcc.h
@@ -140,6 +140,8 @@ extern "C" {
 #define DRM_FORMAT_NV61		fourcc_code('N', 'V', '6', '1') /* 2x1 subsampled Cb:Cr plane */
 #define DRM_FORMAT_NV24		fourcc_code('N', 'V', '2', '4') /* non-subsampled Cr:Cb plane */
 #define DRM_FORMAT_NV42		fourcc_code('N', 'V', '4', '2') /* non-subsampled Cb:Cr plane */
+#define DRM_FORMAT_MT21		fourcc_code('M', 'T', '2', '1') /* Mediatek Block Mode */
+
 
 /*
  * 3 plane YCbCr
diff --git a/src/egl/drivers/dri2/egl_dri2.c b/src/egl/drivers/dri2/egl_dri2.c
index 495429523e7..007d31405e6 100644
--- a/src/egl/drivers/dri2/egl_dri2.c
+++ b/src/egl/drivers/dri2/egl_dri2.c
@@ -2263,6 +2263,9 @@ dri2_num_fourcc_format_planes(EGLint format)
    case DRM_FORMAT_NV21:
    case DRM_FORMAT_NV16:
    case DRM_FORMAT_NV61:
+#ifdef DRM_FORMAT_MT21
+   case DRM_FORMAT_MT21:
+#endif
       return 2;
 
    case DRM_FORMAT_YUV410:
-- 
2.22.0

