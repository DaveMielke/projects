# Copyright 2016 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
#
# This script processes exit values of the usb_updater utility ran by
# cr50-update.conf. See it for details of exit code values.

description     "Startup file to process cr50 firmware updater exit status"
author          "chromium-os-dev@chromium.org"

start on stopped cr50-update

script
  case ${EXIT_STATUS} in
  (0)
    ;;
  ([123])
    logger -t ${UPSTART_JOB} "reboot required ${EXIT_STATUS}"
    reboot
    ;;
  (*)
    logger -t ${UPSTART_JOB} "unexpected cr50-update exit code ${EXIT_STATUS}"
    ;;
  esac

end script
